# DO NOT CHANGE THIS FILE!
# This config is generated by SALTSTACK
# and all change will be overrided on next salt call
{#-
===== FETCH DATA =====
-#}
{%- from "influxdb/defaults.yaml.jinja2" import rawmap with context -%}
{%- from "influxdb/supported_sections.yaml.jinja2" import supported_sections with context -%}
{%- set datamap = salt['grains.filter_by'](rawmap, grain='os', merge=salt['pillar.get']('influxdb')) -%}
{#-
===== COMBINE DATA =====
-#}
{%- set goodParamList = datamap.config -%}
{%- for section_name in supported_sections -%}
    {%- set sectdict = datamap.config[section_name] | default({}) -%}
    {%- do goodParamList.update({section_name:sectdict}) -%}
{%- endfor -%}
{%- if initialConfig == True -%}
    {%- set http_config = goodParamList["http"] | default({"auth-enabled":False}) -%}
    {%- do http_config.update({"auth-enabled": False}) -%}
    {%- do goodParamList.update({"http":http_config}) -%}
{%- endif -%}
{#-
===== PRINT DATA =====
-#}
{%- if "main" in goodParamList and goodParamList["main"] != {} -%}
{%- for mparam, mvalue in goodParamList['main'].items()|default([])|sort -%}
{%- set indents = 40 - mparam|count %}
{% if mvalue == True or mvalue == False -%}
{{ mparam }}{{ '='|indent(indents, true) }} {{mvalue|string|lower}}
{%- else -%}
{{ mparam }}{{ '='|indent(indents, true) }} {{ mvalue }}
{%- endif -%}
{%- endfor -%}
{%- do goodParamList.update({'main':[]}) -%}
{%- endif -%}

{%- for sname,sdata in goodParamList.items() -%}
{%- if sdata %}

[{{ sname }}]
{%- for mparam, mvalue in sdata.items()|default([])|sort -%}
{%- set indents = 40 - mparam|count %}
{% if mvalue == True or mvalue == False -%}
{{ mparam }}{{ '='|indent(indents, true) }} {{mvalue|string|lower}}
{%- else -%}
{{ mparam }}{{ '='|indent(indents, true) }} {{ mvalue }}
{%- endif -%}
{%- endfor -%}
{%- endif -%}
{%- endfor %}

{{ datamap.config.append | default('') }}
